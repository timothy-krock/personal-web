<!DOCTYPE html>
<html>
<head>
  <title>Office Visualisation</title>
  <link rel="icon" href="https://i.imgur.com/NPoFGdS.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="https://platform.linkedin.com/badges/js/profile.js" async defer></script>
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <script src="https://d3js.org/d3.v3.min.js"></script>

  <style>
  small {
    font-family: arial;
  }
  h1 {
    font-family: monospace;
    font-size: 6.5vh;
    font-style: normal;
    font-variant: normal;
    font-weight: 500;
    line-height: 7vh;
  }
  .tab { margin-left: 40px; }
  #head  {
          background-image: url("images/background.jpg");
          padding-top: 15vw;
          background-position: top;
          vertical-align: top;
          background-size: 100vw,70vw;
          background-repeat: repeat-x;

  }
  </style>
</head>
<body>






  <div id="demo" style = "margin-left:10vw;text-align:left;width:80vw;">
    <h1 style = "font-size:8vw;">About the Data:</h1><h3  style = "font-family:monospace;color:grey;">
      <small>

        For these graphs I ran a <a href="https://en.wikipedia.org/wiki/Linear_regression">linear regression</a> on the data
        which was scraped and cleaned in python.
        As a predictive model, it was pretty weak, with R Squared values between .3 and .6 depending on the character included.
        Despite this, we're still able to pluck out
        specific peices of information with statistical significance.
        <br><br>
        "Line" in this context is defined as all the words a character would say in a row
        without being interrupted, and without scenes changing. This is in contrast with the theatrical definition of the word,
        where it is possible for a character to have multiple consecutive lines in the same scene.
        <br><br>
        </small>The first graph <small>
        is powered by the following regression. Using the rating of the show as the dependent variable, this graph
        at uses a character's appearance as a binary independent variable. For instance, if Jim appeared in an episode, the data point
        would be 1, otherwise, it would be 0. This regression allows us to look at the expected effect of each character's appearance
        in the show. For instance, Jim's coefficient is 1.671. This means that, all else equal, we could expect an episode without Jim
        to be rated 1.671 less on IMDB than a comparable episode in which Jim appears.
      </small>

      </h3>
            <table class="table table-hover" style = "font-size:2vw;">
              <thead>
                <tr>
                  <th>Character</th>
                  <th>Coefficient</th>
                  <th>Standard Error</th>
                  <th>t Statistic</th>
                  <th>P-Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Intercept</td>
                  <td>6.1233</td>
                  <td>0.5565</td>
                  <td>11.0034</td>
                  <td>1.242E-21</td>
                </tr>
                <tr style = "background:#b3c3ff">
                  <td >Jim</td>
                  <td>1.6710</td>
                  <td>0.4829</td>
                  <td>3.4603</td>
                  <td style = "background:#99afff">6.814E-4 </td>
                </tr>
                <tr>
                  <td>Angela</td>
                  <td>-0.0463</td>
                  <td>0.1282</td>
                  <td>-0.3613</td>
                  <td>0.7183</td>
                </tr>
                <tr>
                  <td>Jan</td>
                  <td>0.0281</td>
                  <td>0.0949</td>
                  <td>0.2967</td>
                  <td>0.7671</td>
                </tr>
                <tr style = "background:#b3c3ff">
                  <td >Andy</td>
                  <td>0.1510</td>
                  <td>0.0888</td>
                  <td>1.6993</td>
                  <td style = "background:#99afff">0.0911</td>
                </tr>
                <tr>
                  <td>Pam</td>
                  <td>-0.0613</td>
                  <td>0.2326</td>
                  <td>-0.2636</td>
                  <td>0.7924</td>
                </tr>
                <tr>
                  <td>Oscar</td>
                  <td>0.0598</td>
                  <td>0.1163</td>
                  <td>0.5144</td>
                  <td>0.6075</td>
                </tr>
                <tr>
                  <td>Phyllis</td>
                  <td>-0.0187</td>
                  <td>0.1122</td>
                  <td>-0.1671</td>
                  <td>0.8675</td>
                </tr>
                <tr>
                  <td>Meredith</td>
                  <td>0.1152</td>
                  <td>0.0747</td>
                  <td>1.5410</td>
                  <td>0.1252</td>
                </tr>
                <tr style = "background:#99afff">
                  <td>Michael</td>
                  <td>0.5188</td>
                  <td>0.1083</td>
                  <td>4.7896</td>
                  <td style = "background:#4747d1;color:white;">3.604E-06</td>
                </tr>
                <tr>
                  <td>Ryan</td>
                  <td>-0.0374</td>
                  <td>0.0936</td>
                  <td>-0.4000</td>
                  <td>0.6897</td>

                </tr>
                <tr>
                  <td>Darryl</td>
                  <td>0.0275</td>
                  <td>0.0762</td>
                  <td>0.3608</td>
                  <td>0.7187</td>
                </tr>
                <tr>
                  <td>Kelly</td>
                  <td>0.0403</td>
                  <td>0.0943</td>
                  <td>0.4314</td>
                  <td>0.6667</td>
                </tr>
                <tr style = "background:#b3c3ff">
                  <td>Toby</td>
                  <td>0.1214</td>
                  <td>0.0668</td>
                  <td>1.8184</td>
                  <td style = "background:#99afff">0.0708</td>
                </tr>
                <tr style = "background:#b3c3ff">
                  <td>Erin</td>
                  <td>-0.2293</td>
                  <td>0.0972</td>
                  <td>-2.3584</td>
                  <td style = "background:#99afff">0.0195</td>
                </tr>
                <tr>
                  <td>Kevin</td>
                  <td>-0.06957</td>
                  <td>0.1908</td>
                  <td>-0.3601</td>
                  <td>0.7163</td>
                </tr>
                <tr>
                  <td>Stanley</td>
                  <td>0.0680</td>
                  <td>0.1093</td>
                  <td>0.6219</td>
                  <td>0.5348</td>
                </tr>
              </tbody>
            </table>
    <h3>
      <small>




        <br>
        <br>
        The P-value shows the percent chance of a given coefficient being wrong. Many of the characters had P-values greater than
        .5. These characters have a lot of "noise": variance to their expected effect on th ratings. Their coefficients are little more than
        averages of the highly varied numbers, with little correlation to IMDB score.

        All of the characters whose appearance had at least a somewhat statistically significant impact are highlighted in blue. Michael, we
        can see, had what amounts to an undeniable effect on the ratings.

        Additionally, Jim had a very high impact on the ratings. This surprised me, because he's in a lot of episodes. I expected there to
        be almost no statistical significance. Upon further investigation, this is the case because Jim is only absent in a handful of episodes, and they where
        well below the show's average ratings.
      </small>
    </h3>

    <br>
    <h3 style = "font-family:monospace;color:grey;">
        This second regression<small>
         is really interesting. I looked at the ratings against the number of lines the main characters
        had in each episode. The coefficients show the marginal change in ratings to a change in the number of lines a character has.
        In English, if you give a character another line, what happens to the rating?
      </small>
    </h3>



          <table class="table table-hover" style = "font-size:2vw;">
            <thead style = "font-size:2vw;">
              <tr>
                <th>Character</th>
                <th>Coefficient</th>
                <th>Standard Error</th>
                <th>t Statistic</th>
                <th>P-Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Intercept</td>
                <td>7.6816</td>
                <td>0.1159</td>
                <td>66.3017</td>
                <td>6.55E-124</td>
              </tr>
              <tr style = "background:#b3c3ff">
                <td >Jim</td>
                <td>0.0035</td>
                <td>0.0020</td>
                <td>1.7054</td>
                <td style = "background:#99afff">0.0899</td>
              </tr>
              <tr>
                <td>Angela</td>
                <td>-0.0041</td>
                <td>0.0042</td>
                <td>0.9813</td>
                <td>0.3278</td>
              </tr>
              <tr>
                <td>Jan</td>
                <td>0.0040</td>
                <td>0.0030</td>
                <td>1.3401</td>
                <td>0.1820</td>
              </tr>
              <tr>
                <td>Andy</td>
                <td>-0.0008</td>
                <td>0.0020</td>
                <td>-0.3860</td>
                <td>0.7000</td>
              </tr>
              <tr>
                <td>Pam</td>
                <td>0.0004</td>
                <td>0.0024</td>
                <td>0.1511</td>
                <td>0.8801</td>
              </tr>
              <tr>
                <td>Oscar</td>
                <td>-0.0007</td>
                <td>0.0053</td>
                <td>-0.1262</td>
                <td>0.8998</td>
              </tr>
              <tr>
                <td>Phyllis</td>
                <td>0.0052</td>
                <td>0.0083</td>
                <td>0.7202</td>
                <td>0.4724</td>
              </tr>
              <tr>
                <td>Meredith</td>
                <td>0.0022</td>
                <td>0.0083</td>
                <td>0.2638</td>
                <td>0.7923</td>
              </tr>
              <tr style = "background:#99afff">
                <td>Michael</td>
                <td>0.0050</td>
                <td>0.0010</td>
                <td>4.8563</td>
                <td style = "background:#4747d1;color:white;">2.685E-06</td>
              </tr>
              <tr>
                <td>Ryan</td>
                <td>-0.0022</td>
                <td>0.0034</td>
                <td>-0.6527</td>
                <td>0.5148</td>

              </tr>
              <tr>
                <td>Darryl</td>
                <td>-0.0004</td>
                <td>0.0034</td>
                <td>-0.1056</td>
                <td>0.9160</td>
              </tr>
              <tr>
                <td>Kelly</td>
                <td>0.0039</td>
                <td>0.0070</td>
                <td>0.5571</td>
                <td>0.5782</td>
              </tr>
              <tr>
                <td>Toby</td>
                <td>0.0020</td>
                <td>0.0050</td>
                <td>0.4052</td>
                <td>0.6858</td>
              </tr>
              <tr style = "background:#b3c3ff">
                <td>Erin</td>
                <td>-0.0066</td>
                <td>0.0038</td>
                <td>-1.7125</td>
                <td style = "background:#99afff">0.0886</td>
              </tr>
              <tr style = "background:#b3c3ff">
                <td>Kevin</td>
                <td>-0.0112</td>
                <td>0.0056</td>
                <td>-01.8732</td>
                <td style = "background:#99afff">0.0627</td>
              </tr>
              <tr style = "background:#b3c3ff">
                <td>Stanley</td>
                <td>0.0147</td>
                <td>0.0087</td>
                <td>1.6942</td>
                <td style = "background:#99afff">0.0920</td>
              </tr>
            </tbody>
          </table>

    <h3>
      <small>
        Statistically significantly, giving Michael more lines comes with a better IMDB rating. Jim is correlated with a positive marginal
        rate of return to IMDB in both visualizations as well.

        Additionally, and I think this is a really fun takeaway, Stanley and Kevin have far and away the largest coefficients in this regression,
        which implies that they really shine in most of the episodes where they have a lot of lines.



      </small>
    </h3>
  </div>




<br><br>

<div style = "position:relative;left:10vw;width:80vw;">
  <a style = "position:relative;width:80vw;"
  class = "btn btn-primary" href = "office.html">Back to the Visualization</a>
</div>
<br><br>




</body>
